<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="partner_ageing_pdf_report">
        <t t-call="web.html_container">
            <t t-set="data_report_margin_top" t-value="12"/>
            <t t-set="data_report_header_spacing" t-value="9"/>
            <t t-set="data_report_dpi" t-value="110"/>
            <t t-call="web.internal_layout">
                <div class="page" style="font-family: Arial, sans-serif; padding: 0 20px;">
                    <center>
                        <h2 style="margin-bottom: 5px;">Partner Ageing</h2>
                        <div style="margin-bottom: 20px;">
                        <br/><br/>
                        </div>
                    </center>

                    <table class="table" style="width: 100%; border-collapse: collapse; font-size: 12pt;">
                        <thead>
                            <tr style="background-color: #f5f5f5;">
                                <th style="width: 10%; text-align: left; padding: 8px; border-bottom: 1px solid #ddd;">Move</th>
                                <th style="width: 8%; text-align: center; padding: 8px; border-bottom: 1px solid #ddd;">Invoice Date</th>
                                <th style="width: 8%; text-align: center; padding: 8px; border-bottom: 1px solid #ddd;">Due Date</th>
                                <th style="width: 5%; text-align: center; padding: 8px; border-bottom: 1px solid #ddd;">Journal</th>
                                <th style="width: 7%; text-align: center; padding: 8px; border-bottom: 1px solid #ddd;">Account</th>
                                <th style="width: 8%; text-align: right; padding: 8px; border-bottom: 1px solid #ddd;">
                                    <t t-if="periods['0']" t-esc="periods['0']['name']"/><t t-else="">At Date</t>
                                </th>
                                <th style="width: 9%; text-align: right; padding: 8px; border-bottom: 1px solid #ddd;">
                                    <t t-if="periods['1']" t-esc="periods['1']['name']"/><t t-else="">1-60</t>
                                </th>
                                <th style="width: 9%; text-align: right; padding: 8px; border-bottom: 1px solid #ddd;">
                                    <t t-if="periods['2']" t-esc="periods['2']['name']"/><t t-else="">61-120</t>
                                </th>
                                <th style="width: 9%; text-align: right; padding: 8px; border-bottom: 1px solid #ddd;">
                                    <t t-if="periods['3']" t-esc="periods['3']['name']"/><t t-else="">121-180</t>
                                </th>
                                <th style="width: 9%; text-align: right; padding: 8px; border-bottom: 1px solid #ddd;">
                                    <t t-if="periods['4']" t-esc="periods['4']['name']"/><t t-else="">181-240</t>
                                </th>
                                <th style="width: 9%; text-align: right; padding: 8px; border-bottom: 1px solid #ddd;">
                                    <t t-if="periods['5']" t-esc="periods['5']['name']"/><t t-else="">240+</t>
                                </th>
                                <th style="width: 9%; text-align: right; padding: 8px; border-bottom: 1px solid #ddd;">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="partners" t-as="partner" t-key="partner.id">
                                <tr style="background-color: #f9f9f9; border-bottom: 1px solid #ddd;">
                                    <td style="text-align: left; padding: 6px; font-weight: bold;">
                                        <t t-esc="partner['name']"/>
                                    </td>
                                    <td/><td/><td/><td/>
                                    <td style="text-align: right; padding: 6px;" t-esc="partner['period0']"/>
                                    <td style="text-align: right; padding: 6px;" t-esc="partner['period1']"/>
                                    <td style="text-align: right; padding: 6px;" t-esc="partner['period2']"/>
                                    <td style="text-align: right; padding: 6px;" t-esc="partner['period3']"/>
                                    <td style="text-align: right; padding: 6px;" t-esc="partner['period4']"/>
                                    <td style="text-align: right; padding: 6px;" t-esc="partner['period5']"/>
                                    <td style="text-align: right; padding: 6px; font-weight: bold;" t-esc="partner['total']"/>
                                </tr>
                                
                                <t t-if="partner.get('name', '') in expandedPartners">
                                    <t t-foreach="partner['journal_items']" t-as="item" t-key="item.id">
                                        <tr style="border-bottom: 1px solid #eee;">
                                            <td style="text-align: left; padding: 6px;">
                                                <t t-esc="item['move_name']"/>
                                            </td>
                                            <td style="text-align: center; padding: 6px;"><t t-esc="item['invoice_date']"/></td>
                                            <td style="text-align: center; padding: 6px;"><t t-esc="item['due_date']"/></td>
                                            <td style="text-align: center; padding: 6px;"><t t-if="item['journal_id']" t-esc="item['journal_id']"/></td>
                                            <td style="text-align: center; padding: 6px;"><t t-esc="item['account_code']"/></td>
                                            <td style="text-align: right; padding: 6px;">
                                                <t t-if="item['period_key'] == 'period0'" t-esc="item['amount']"/>
                                                <t t-else="">$ 0.00</t>
                                            </td>
                                            <td style="text-align: right; padding: 6px;">
                                                <t t-if="item['period_key'] == 'period1'" t-esc="item['amount']"/>
                                                <t t-else="">$ 0.00</t>
                                            </td>
                                            <td style="text-align: right; padding: 6px;">
                                                <t t-if="item['period_key'] == 'period2'" t-esc="item['amount']"/>
                                                <t t-else="">$ 0.00</t>
                                            </td>
                                            <td style="text-align: right; padding: 6px;">
                                                <t t-if="item['period_key'] == 'period3'" t-esc="item['amount']"/>
                                                <t t-else="">$ 0.00</t>
                                            </td>
                                            <td style="text-align: right; padding: 6px;">
                                                <t t-if="item['period_key'] == 'period4'" t-esc="item['amount']"/>
                                                <t t-else="">$ 0.00</t>
                                            </td>
                                            <td style="text-align: right; padding: 6px;">
                                                <t t-if="item['period_key'] == 'period5'" t-esc="item['amount']"/>
                                                <t t-else="">$ 0.00</t>
                                            </td>
                                            <td style="text-align: right; padding: 6px;" t-esc="item['amount']"/>
                                        </tr>
                                    </t>
                                </t>
                            </t>
                            
                            <tr style="background-color: #f0f0f0; border-top: 2px solid #ddd; font-weight: bold;">
                                <td style="text-align: left; padding: 8px;">Total</td>
                                <td/><td/><td/><td/>
                                <td style="text-align: right; padding: 8px;" t-esc="period_total['period0']"/>
                                <td style="text-align: right; padding: 8px;" t-esc="period_total['period1']"/>
                                <td style="text-align: right; padding: 8px;" t-esc="period_total['period2']"/>
                                <td style="text-align: right; padding: 8px;" t-esc="period_total['period3']"/>
                                <td style="text-align: right; padding: 8px;" t-esc="period_total['period4']"/>
                                <td style="text-align: right; padding: 8px;" t-esc="period_total['period5']"/>
                                <td style="text-align: right; padding: 8px;" t-esc="period_total['total']"/>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </t>
        </t>
    </template>

<record id="paper_format_partnerageing" model="report.paperformat">
    <field name="name">Partner Ageing Paper Format</field>
    <field name="default" eval="True" />
    <field name="format">custom</field>
    <field name="page_height">297</field>
    <field name="page_width">250</field>
    <field name="orientation">Portrait</field>
    <field name="margin_top">10.00</field>
    <field name="header_spacing">35</field>
    <field name="dpi">125</field>
</record>

<record id="action_partner_ageing_pdf_report" model="ir.actions.report">
    <field name="name">Partner Ageing</field>
    <field name="model">partner.ageing</field>
    <field name="report_type">qweb-pdf</field>
    <field name="report_name">bi_financial_reports_comm.partner_ageing_pdf_report</field>
    <field name="report_file">bi_financial_reports_comm.partner_ageing_pdf_report</field>
    <field name="print_report_name">'Partner Ageing'</field>
    <field name="binding_model_id" ref="model_partner_ageing"/>
    <field name="binding_type">report</field>
    <field name="paperformat_id" ref="bi_financial_reports_comm.paper_format_partnerageing"/>
</record>
</odoo>